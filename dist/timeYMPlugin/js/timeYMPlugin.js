/* build at 2013-07-15 10:07:39 */
!function(a){a.fn.timeYM=function(b){function c(a,b,c){var d=a||1949,e=b||2013,f=g.type||"year",h=0,i=[];for(f&&"month"==f&&(d=a>12?1:a||1,e=b>=12?12:b||12),c=c||e,h=Math.ceil((e-c+1)/12);e>=d;)i.push(e),e--;return f&&"month"==f&&(i=i.reverse()),"year"==f&&(h=0==h?1:h,i.curPage=h,i.pageLen=Math.ceil(i.length/12)),i}function d(b){a("."+g.boxCssClass).remove();var d,f,i=a("<div />"),j="",k="",l=[],m="年",n=!0,o=0,p=0,q=b.offset(),r=b.siblings("[date-type="+b.attr("date-type")+"]"),s=b.siblings("[date-type][date-type!="+b.attr("date-type")+"]");if(0==b.length)return alert("ID不存在，请检查"),!1;for(i.attr({id:b.attr("id")+"_box","class":g.boxCssClass,"data-box-for":g.txtId}),i.css({left:q.left,top:q.top+b.height()}),n=b.index()<r.index()?!0:!1,"year"==g.type?(l=n&&""!=r.val()?c(g.minDate,r.val(),b.val()):n||""==r.val()?c(g.minDate,g.maxDate,b.val()):c(r.val(),g.maxDate,b.val()),j='<div class="tit"><em class="prev">&lt;&lt; </em>请选择'+g.title+'<em class="next"> &gt;&gt;</em></div>'):(j='<div class="tit">请选择'+g.title+"</div>",m="月",l=""!=s.eq(0).val()&&s.eq(0).val()==s.eq(1).val()?n&&""!=r.val()?c(g.minDate,r.val(),b.val()):n||""==r.val()?c():c(r.val(),g.maxDate,b.val()):c(g.minDate,g.maxDate,b.val())),j+='<div class="timeCon">',j+='<div class="oneBlock">',d=0,f=l.length;f>d;d++)j+="<span>"+l[d]+m+"</span> ",0==(d+1)%12&&(j+="</div>",j+='<div class="oneBlock">');j+="</div>",j+="</div>","end"==g.seType&&(k='<a class="btnSinceNow" href="javascript:void(0);">[至今]</a> '),j+='<div class="btns">'+k+'<a href="javascript:void(0);" class="clear">[清空]</a>'+' <a href="javascript:void(0);" class="btnClose">[关闭]</a></div>',i.append(a(j)),a("body").append(i),"year"==g.type&&(o=l.pageLen,p=l.curPage,h[e.substring(1)+"_time_page"]=o,h[e.substring(1)+"_cur_page"]=p,1==o?a(e+"_box .tit em.prev, "+e+"_box .tit em.next").addClass("disable"):1==p?a(e+"_box .tit em.prev").addClass("disable"):p==o&&a(e+"_box .tit em.next").addClass("disable"),a(e+"_box .timeCon").css("left",-a(e+"_box").width()*(p-1))),""!=b.val()&&a(e+"_box .timeCon span").each(function(){return a(this).text().replace(/年|月/,"")==b.val()?(a(this).addClass("cur"),!1):void 0})}$this=a(this);var e="",f={txtId:"#"+$this.attr("id"),txtCssClass:"date_input",title:"开始年份",minDate:1949,maxDate:(new Date).getFullYear(),method:"click",type:"year",boxCssClass:"timeYM_box",seType:"start"},g=a.extend(f,b),h={};e=g.txtId,$this.attr({name:$this.attr("id"),"class":g.txtCssClass,"date-type":g.type,"se-type":g.seType}),$this.bind(g.method,function(b){(b||window.event).stopPropagation(),0==a(e+"_box").length&&d(a(g.txtId),g.type)}),$this.keydown(function(a){return a=a||window.event,116==a.keyCode||9==a.keyCode||8==a.keyCode?!0:!1}),0!=a(".modifyEndYM").length&&0!=a("#sinceNow").length&&(a("#sinceNow").val((new Date).getTime()),a("[se-type=end]").attr("disabled",!0).hide().next("span.txt").hide()),a(document).click(function(){a("."+g.boxCssClass).remove()}),a(e+"_box").live("click",function(a){(a||window.event).stopPropagation()}),a(e+"_box .tit em.prev").live("click",function(){var b=a(e+"_box").width();h[e.substring(1)+"_cur_page"]-1>0&&!a(e+"_box .timeCon").is(":animated")&&(h[e.substring(1)+"_cur_page"]-=1,a(e+"_box .timeCon").animate({left:-b*(h[e.substring(1)+"_cur_page"]-1)},function(){-a(e+"_box .tit em.next").removeClass("disable"),0==h[e.substring(1)+"_cur_page"]-1&&a(e+"_box .tit em.prev").addClass("disable")}))}),a(e+"_box .tit em.next").live("click",function(){var b=a(e+"_box").width();h[e.substring(1)+"_cur_page"]<h[e.substring(1)+"_time_page"]&&!a(e+"_box .timeCon").is(":animated")&&(a(e+"_box .timeCon").animate({left:-b*h[e.substring(1)+"_cur_page"]},function(){a(e+"_box .tit em.prev").removeClass("disable"),h[e.substring(1)+"_cur_page"]==h[e.substring(1)+"_time_page"]&&a(e+"_box .tit em.next").addClass("disable")}),h[e.substring(1)+"_cur_page"]+=1)}),a(e+"_box .timeCon .oneBlock span").live("click",function(){var b=a(e+"_box"),c=b.attr("data-box-for"),d=a(c).nextAll("[date-type]");a(c).val(a(this).text().replace(/年|月/,"")),a(this).addClass("cur").siblings().removeClass("cur"),d.length>0&&""==d.eq(0).val()&&d.eq(0).is(":visible")&&d.eq(0).focus().trigger(g.method),b.remove()}),a.browser.msie&&"6.0"==a.browser.version&&(a(e+"_box .timeCon .oneBlock span").live("mouseover",function(){a(this).addClass("cur")}),a(e+"_box .timeCon .oneBlock span").live("mouseout",function(){a(this).removeClass("cur")})),a(e+"_box .btns .btnSinceNow").live("click",function(){var b=(new Date).getTime(),c='<span class="modifyEndYM" title="修改结束年月">[现在]</span><input type="hidden" value="" id="sinceNow" />';$this.parents().find("[se-type=end]").hide().val("").next("span.txt").hide(),0==a("span.modifyEndYM").length?$this.parents().find("span.txt:last").after(c).hide():a("span.modifyEndYM").show(),a("#sinceNow").val(b),a("[se-type=end]").attr("disabled",!0),a(e+"_box").remove()}),a("span.modifyEndYM").live("click",function(){return $this.parents().find("[se-type=end],span").show(),a("[se-type=end]").removeAttr("disabled"),$this.parents().find("[se-type=end]").eq(0).trigger(g.method).focus().val(""),a("#sinceNow").val(""),a(this).hide(),!1}),a(e+"_box .btns .clear").live("click",function(){a(e+"_box .timeCon .oneBlock span.cur").removeClass("cur"),a(a(e+"_box").attr("data-box-for")).val("").focus()}),a(e+"_box .btns .btnClose").live("click",function(){a(e+"_box").remove()})}}(jQuery);